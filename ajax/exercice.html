<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exercice</title>
    <style>
        .table { width: 100%; border-collapse: collapse; border-spacing: 0; }
        .table thead td { border-bottom: 1px solid #ccc; padding: 6px }
        .table tbody td { border-top: 1px solid #ccc; padding: 6px }
    </style>

    <script>

        function afficher(json){
            let html = "";

            for( product of json){
                html += `<tr>
    <td>${product.id}</td>
    <td>${product.name}</td>
    <td>${product.description}</td>
    <td>${product.price}</td>
</tr>`;
            }

            document.querySelector('.table tbody').innerHTML = html;
        }

        window.addEventListener('DOMContentLoaded', function(){
            let xhr = new XMLHttpRequest();
            let btn = document.querySelector('#products');
            let message = document.querySelector('#message');

            btn.addEventListener('click', function(){

                let url = 'http://localhost:8888/php-avancee-fullstack/index.php/api/products';

                xhr.onreadystatechange = function(){

                    message.innerText = "En attente d'une r√©ponse du serveur";

                    if( xhr.readyState === 4 && xhr.status === 200){
                        afficher(xhr.response);
                        message.innerText = null;
                    }

                };

                xhr.responseType = "json";
                xhr.open('GET', url, true);
                xhr.send();
            });

        });

    </script>
</head>
<body>

<h1>Exercice Ajax</h1>
<hr />

<button id="products">Lister les Produits</button>
<p id="message"></p>

<table class="table">
    <thead>
        <tr>
            <td>ID</td>
            <td>Nom</td>
            <td>Description</td>
            <td>Prix</td>
        </tr>
    </thead>
    <tbody>

    </tbody>
</table>

</body>
</html>